using System;
using System.Diagnostics;
using System.Windows.Forms;

namespace Stop_Watch_Form
{
    public partial class Form1 : Form
    {
        // Kronometre nesneleri
        Timer uiTimer = new Timer();
        Stopwatch swMain = new Stopwatch();   // ana süre
        Stopwatch swLap = new Stopwatch();    // lap süresi
        int lapNumber = 0;

        public Form1()
        {
            InitializeComponent();

            // Timer ayarı
            uiTimer.Interval = 100;           // 0.1 saniye
            uiTimer.Tick += UiTimer_Tick;

            // Başlangıç yazıları
            lblMainTime.Text = "00 : 00 : 00 . 0";
            lblLapTime.Text = "00 : 00 : 00 . 0";
            rtbLapDetails.Text = "Lap Details";
        }

        // ZAMAN FORMATLAYICI
        private string FormatTime(TimeSpan ts)
        {
            // hh:mm:ss.d (d = 1/10 saniye)
            return string.Format("{0:00} : {1:00} : {2:00} . {3}",
                ts.Hours, ts.Minutes, ts.Seconds, ts.Milliseconds / 100);
        }

        // TIMER TICK – her 0.1 sn'de label'ları günceller
        private void UiTimer_Tick(object sender, EventArgs e)
        {
            lblMainTime.Text = FormatTime(swMain.Elapsed);
            lblLapTime.Text = FormatTime(swLap.Elapsed);
        }

        // START butonu (Click kısmında btnStart_Click_1 yazıyor)
        private void btnStart_Click_1(object sender, EventArgs e)
        {
            if (!swMain.IsRunning)
            {
                swMain.Start();
                swLap.Start();
                uiTimer.Start();
            }
        }

        // STOP butonu
        private void btnStop_Click_1(object sender, EventArgs e)
        {
            if (swMain.IsRunning)
            {
                swMain.Stop();
                swLap.Stop();
                uiTimer.Stop();
            }
        }

        // LAP butonu
        private void btnLap_Click_1(object sender, EventArgs e)
        {
            if (!swMain.IsRunning) return;   // çalışmıyorsa lap alma

            lapNumber++;

            string lapText = $"Lap {lapNumber:00}  -  {FormatTime(swLap.Elapsed)}";

            if (rtbLapDetails.Text == "Lap Details")
                rtbLapDetails.Clear();

            rtbLapDetails.AppendText(lapText + Environment.NewLine);

            // Lap süresini sıfırla, ana süre devam etsin
            swLap.Restart();
        }

        // RESET label'ına tıklama
        private void lblResetTop_Click(object sender, EventArgs e)
        {
            uiTimer.Stop();
            swMain.Reset();
            swLap.Reset();
            lapNumber = 0;

            lblMainTime.Text = "00 : 00 : 00 . 0";
            lblLapTime.Text = "00 : 00 : 00 . 0";
            rtbLapDetails.Text = "Lap Details";
        }
    }
}
